{"remainingRequest":"C:\\Users\\User\\Desktop\\Happy road\\Happy-road\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\User\\Desktop\\Happy road\\Happy-road\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\User\\Desktop\\Happy road\\Happy-road\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\User\\Desktop\\Happy road\\Happy-road\\src\\views\\Coupon.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\User\\Desktop\\Happy road\\Happy-road\\src\\views\\Coupon.vue","mtime":1561452223419},{"path":"C:\\Users\\User\\Desktop\\Happy road\\Happy-road\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\User\\Desktop\\Happy road\\Happy-road\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\User\\Desktop\\Happy road\\Happy-road\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\User\\Desktop\\Happy road\\Happy-road\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport $ from \"jquery\";\nimport Pagination from \"./Pagination\";\nexport default {\n  data: function data() {\n    return {\n      isNew: false,\n      isLoading: false,\n      newtime: new Date(),\n      coupons: {},\n      pagination: {},\n      setcoupon: {\n        title: \"\",\n        is_enabled: 1,\n        percent: 0,\n        due_date: 0,\n        code: \"\"\n      }\n    };\n  },\n  watch: {\n    newtime: function newtime() {\n      var vm = this;\n      var timestamp = Math.floor(new Date(vm.newtime) / 1000);\n      vm.setcoupon.due_date = timestamp;\n    }\n  },\n  components: {\n    Pagination: Pagination\n  },\n  methods: {\n    getcoupon: function getcoupon() {\n      var page = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n      //ES6用法 如果有傳參數近來 使用傳進來的參數 如果沒有 使用預設值1\n      var api = \"\".concat(process.env.VUE_APP_APIPATH, \"/api/\").concat(process.env.VUE_APP_COUSTOMPATH, \"/admin/coupons?page=\").concat(page);\n      var vm = this;\n      vm.isLoading = true;\n      console.log(api);\n      this.$http.get(api).then(function (response) {\n        console.log(response.data);\n        vm.pagination = response.data.pagination;\n        vm.coupons = response.data.coupons;\n        vm.isLoading = false;\n        /*  if(response.data.success){\r\n        vm.$set(vm.coupons,'coupons',response.coupons) //無get set如要使用v model 要使用強制寫入\r\n        } */\n      });\n    },\n    addcoupon: function addcoupon(setcoupon) {\n      var _this = this;\n\n      var api = \"\".concat(process.env.VUE_APP_APIPATH, \"/api/\").concat(process.env.VUE_APP_COUSTOMPATH, \"/admin/coupon\");\n      var httpMethos = \"post\";\n      var vm = this;\n      var coupon = {\n        title: setcoupon.title,\n        is_enabled: setcoupon.is_enabled,\n        percent: setcoupon.percent,\n        due_date: setcoupon.due_date,\n        code: setcoupon.code\n      };\n      vm.isLoading = true;\n      /*  const timestamp = Math.floor(Date.now() / 1000); */\n\n      if (!vm.isNew) {\n        console.log(api);\n        httpMethos = \"put\";\n        api = \"\".concat(process.env.VUE_APP_APIPATH, \"/api/\").concat(process.env.VUE_APP_COUSTOMPATH, \"/admin/coupon/\").concat(vm.setcoupon.id);\n        this.$http[httpMethos](api, {\n          data: coupon\n        }).then(function (response) {\n          console.log(api);\n          vm.isLoading = false;\n          $(\"#couponmodal\").modal(\"hide\");\n\n          _this.getcoupon();\n        });\n      } else {\n        this.$http[httpMethos](api, {\n          data: vm.setcoupon\n        }).then(function (response) {\n          console.log(api);\n          vm.isLoading = false;\n          $(\"#couponmodal\").modal(\"hide\");\n          console.log(vm.newtime);\n\n          _this.getcoupon();\n        });\n      }\n    },\n    delcoupon: function delcoupon(id) {\n      var _this2 = this;\n\n      var api = \"\".concat(process.env.VUE_APP_APIPATH, \"/api/\").concat(process.env.VUE_APP_COUSTOMPATH, \"/admin/coupon/\").concat(id);\n      var vm = this;\n      vm.isLoading = true;\n      this.$http.delete(api).then(function (response) {\n        console.log(response);\n        vm.isLoading = false;\n\n        _this2.getcoupon();\n      });\n    },\n    openmodal: function openmodal(isNew, item) {\n      var vm = this;\n\n      if (isNew) {\n        vm.setcoupon = {};\n        vm.newtime = '';\n        vm.isNew = true;\n      } else {\n        vm.setcoupon = Object.assign({}, item);\n        vm.newtime = '';\n        vm.isNew = false;\n      }\n\n      $(\"#couponmodal\").modal(\"show\");\n    }\n  },\n  computed: {\n    formatTime: function formatTime() {\n      console.log(this.newDate);\n      /*  var dates = new Date(this.newDate * 1000);\r\n      var year = dates.getFullYear();\r\n      var month = dates.getMonth() + 1;\r\n      var date = dates.getDate() + 1;\r\n      var hours = dates.getHours();\r\n      var minutes = dates.getMinutes();\r\n      var seconds = dates.getSeconds();\r\n      return `${year}/${month}/${date} ${hours}:${minutes}:${seconds}`; */\n    }\n  },\n  created: function created() {\n    this.getcoupon();\n  }\n};",{"version":3,"sources":["Coupon.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div>\r\n    <loading :active.sync=\"isLoading\"></loading>\r\n    <div class=\"py-4 text-right\">\r\n      <button class=\"btn btn-primary\" @click=\"openmodal(true)\">新增優惠券</button>\r\n    </div>\r\n    <table class=\"table table-hover\">\r\n      <thead>\r\n        <tr>\r\n          <th scope=\"col\">優惠券名稱</th>\r\n          <th scope=\"col\">優惠券代碼</th>\r\n          <th scope=\"col\">到期日</th>\r\n          <th scope=\"col\">折扣數</th>\r\n          <th scope=\"col\" width=\"150\">刪除優惠券</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr v-for=\"item in coupons\" :key=\"item.id\">\r\n          <td>{{item.title}}</td>\r\n          <td>{{item.code}}</td>\r\n          <td>{{item.due_date |normaltime}}</td>\r\n          <td>{{item.percent}}%</td>\r\n          <td>\r\n            <button class=\"btn btn-outline-primary btn-sm mr-2\" @click=\"openmodal(false,item)\">修改</button>\r\n            <button class=\"btn btn-outline-danger btn-sm\" @click=\"delcoupon(item.id)\">刪除</button>\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n    <Pagination :pages=\"pagination\" @returnPageData=\"getcoupon\"></Pagination>\r\n\r\n    <div class=\"modal\" tabindex=\"-1\" role=\"dialog\" id=\"couponmodal\">\r\n      <div class=\"modal-dialog\" role=\"document\">\r\n        <div class=\"modal-content\">\r\n          <div class=\"modal-header\">\r\n            <h5 class=\"modal-title\">新增優惠券</h5>\r\n            <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\r\n              <span aria-hidden=\"true\">&times;</span>\r\n            </button>\r\n          </div>\r\n          <div class=\"modal-body\">\r\n            <div class=\"form-group\">\r\n              <label for=\"coupon-title\">請輸入優惠券名稱</label>\r\n              <input\r\n                type=\"text\"\r\n                class=\"form-control mt-2\"\r\n                id=\"coupon-title\"\r\n                placeholder=\"優惠券名稱\"\r\n                v-model=\"setcoupon.title\"\r\n              >\r\n            </div>\r\n            <div class=\"form-group\">\r\n              <label for=\"coupon-title\">請輸入優惠券到期日</label>\r\n              <input\r\n                type=\"date\"\r\n                class=\"form-control mt-2\"\r\n                id=\"coupon-title\"\r\n                placeholder=\"優惠券到期日\"\r\n                v-model=\"newtime\"\r\n              >\r\n            </div>\r\n            <div class=\"form-group\">\r\n              <label for=\"coupon-title\">請輸入折扣%數</label>\r\n              <input\r\n                type=\"number\"\r\n                class=\"form-control mt-2\"\r\n                id=\"coupon-title\"\r\n                placeholder\r\n                v-model=\"setcoupon.percent\"\r\n                oninput=\"if(value<0) value=1;if(value>100)value=100\"\r\n              >\r\n            </div>\r\n            <div class=\"form-group\">\r\n              <label for=\"coupon-title\">請輸入優惠券使用代碼</label>\r\n              <input\r\n                type=\"text\"\r\n                class=\"form-control mt-2\"\r\n                id=\"coupon-title\"\r\n                placeholder\r\n                v-model=\"setcoupon.code\"\r\n              >\r\n            </div>\r\n          </div>\r\n          <div class=\"modal-footer\">\r\n            <button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">關閉</button>\r\n            <button type=\"button\" class=\"btn btn-primary\" @click=\"addcoupon(setcoupon)\">確認</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport $ from \"jquery\";\r\nimport Pagination from \"./Pagination\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      isNew: false,\r\n      isLoading: false,\r\n      newtime: new Date(),\r\n      coupons: {},\r\n      pagination: {},\r\n      setcoupon: {\r\n        title: \"\",\r\n        is_enabled: 1,\r\n        percent: 0,\r\n        due_date: 0,\r\n        code: \"\"\r\n      }\r\n    };\r\n  },\r\n  watch: {\r\n    newtime() {\r\n      const vm = this;\r\n      const timestamp = Math.floor(new Date(vm.newtime) / 1000);\r\n      vm.setcoupon.due_date = timestamp;\r\n    }\r\n  },\r\n  components: {\r\n    Pagination\r\n  },\r\n  methods: {\r\n    getcoupon(page = 1) {\r\n      //ES6用法 如果有傳參數近來 使用傳進來的參數 如果沒有 使用預設值1\r\n      const api = `${process.env.VUE_APP_APIPATH}/api/${\r\n        process.env.VUE_APP_COUSTOMPATH\r\n      }/admin/coupons?page=${page}`;\r\n      const vm = this;\r\n      vm.isLoading = true;\r\n      console.log(api);\r\n      this.$http.get(api).then(response => {\r\n        console.log(response.data);\r\n        vm.pagination = response.data.pagination;\r\n        vm.coupons = response.data.coupons;\r\n        vm.isLoading = false;\r\n        /*  if(response.data.success){\r\n        vm.$set(vm.coupons,'coupons',response.coupons) //無get set如要使用v model 要使用強制寫入\r\n        } */\r\n      });\r\n    },\r\n    addcoupon(setcoupon) {\r\n      let api = `${process.env.VUE_APP_APIPATH}/api/${\r\n        process.env.VUE_APP_COUSTOMPATH\r\n      }/admin/coupon`;\r\n      let httpMethos = \"post\";\r\n      const vm = this;\r\n      const coupon = {\r\n        title: setcoupon.title,\r\n        is_enabled: setcoupon.is_enabled,\r\n        percent: setcoupon.percent,\r\n        due_date: setcoupon.due_date,\r\n        code: setcoupon.code\r\n      };\r\n      vm.isLoading = true;\r\n      /*  const timestamp = Math.floor(Date.now() / 1000); */\r\n      if (!vm.isNew) {\r\n        console.log(api);\r\n        httpMethos = \"put\";\r\n        api = `${process.env.VUE_APP_APIPATH}/api/${\r\n          process.env.VUE_APP_COUSTOMPATH\r\n        }/admin/coupon/${vm.setcoupon.id}`;\r\n\r\n        this.$http[httpMethos](api, { data: coupon }).then(response => {\r\n          console.log(api);\r\n          vm.isLoading = false;\r\n          $(\"#couponmodal\").modal(\"hide\");\r\n          this.getcoupon();\r\n        });\r\n      } else {\r\n        this.$http[httpMethos](api, { data: vm.setcoupon }).then(response => {\r\n          console.log(api);\r\n          vm.isLoading = false;\r\n          $(\"#couponmodal\").modal(\"hide\");\r\n          console.log(vm.newtime);\r\n          this.getcoupon();\r\n        });\r\n      }\r\n    },\r\n    delcoupon(id) {\r\n      const api = `${process.env.VUE_APP_APIPATH}/api/${\r\n        process.env.VUE_APP_COUSTOMPATH\r\n      }/admin/coupon/${id}`;\r\n      const vm = this;\r\n      vm.isLoading = true;\r\n      this.$http.delete(api).then(response => {\r\n        console.log(response);\r\n        vm.isLoading = false;\r\n        this.getcoupon();\r\n      });\r\n    },\r\n\r\n    openmodal(isNew, item) {\r\n      const vm = this;\r\n      if (isNew) {\r\n        vm.setcoupon = {};\r\n        vm.newtime = '';\r\n        vm.isNew = true;\r\n      } else {\r\n        vm.setcoupon = Object.assign({}, item);\r\n        vm.newtime = '';\r\n        vm.isNew = false;\r\n      }\r\n      $(\"#couponmodal\").modal(\"show\");\r\n    }\r\n  },\r\n  computed: {\r\n    formatTime() {\r\n      console.log(this.newDate);\r\n      /*  var dates = new Date(this.newDate * 1000);\r\n      var year = dates.getFullYear();\r\n      var month = dates.getMonth() + 1;\r\n      var date = dates.getDate() + 1;\r\n      var hours = dates.getHours();\r\n      var minutes = dates.getMinutes();\r\n      var seconds = dates.getSeconds();\r\n      return `${year}/${month}/${date} ${hours}:${minutes}:${seconds}`; */\r\n    }\r\n  },\r\n\r\n  created() {\r\n    this.getcoupon();\r\n  }\r\n};\r\n</script>\r\n"],"sourceRoot":"src/views"}]}